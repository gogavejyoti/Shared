 public string Transform(SummaryPlannerRequest request)
        {
            var sb = new StringBuilder();
            sb.AppendLine(@$"
 - Analyze the provided capacity dataset (Actual & Planned), broken down by LOB, Geo, Site, and Week.
 - Identify risks, anomalies, capacity shortages, overstaffing, deviations, and trend changes.
 - Mention specific geographies or LOBs with challenges.
- Consider region-specific holiday periods that may affect staffing, availability, SLAs, and productivity.
- Provide **clear alerts**, **trend-based insights**, and **actionable recommendations** that business users can take.
- Use concise, professional language.
- Please review shrinkage for upcoming geo-wise holiday period and ensure that shrinkage is not identical across all weeks.
- Future recommendations should apply to dates on or after ${request.Weeks.NextWeek} based on actual trends.
- Output must be in **HTML Inline styling** with symbolic svg images and sections.
- Highlight important numbers and keywords with inline style and max width should be 100%.
    - Green words (stable areas): style=""color: #27ae60; font-weight: bold;
    - Amber words (warnings): style=""color: #f39c12; font-weight: bold;
    - Red words (critical): style=""color: #e74c3c; font-weight: bold;
- Use a visually appealing illustrative theme. 
Input:
");
            // Group data by LOB + Geo + Site
            var grouped = request.Data.GroupBy(d => new { d.SheetName, d.Geo, d.Site });
            sb.AppendLine(@$"   - <strong>Overall Assessment:</strong><br/>\r\n        
                                        - <Insert overall assessment text here (2–3 lines).>");

            foreach (var group in grouped)
            {
                sb.AppendLine($"LOB: {group.Key.SheetName} | Geo: {group.Key.Geo} | Site: {group.Key.Site}");

                // ------------------ Planned vs Actual Comparison ------------------
                var plannedMetrics = group.Where(g => g.Header.StartsWith("Planned", System.StringComparison.OrdinalIgnoreCase)).ToList();
                var actualMetrics = group.Where(g => g.Header.StartsWith("Actual", System.StringComparison.OrdinalIgnoreCase)).ToList();
                var staffingPer = group.FirstOrDefault(x => x.Header.Equals("Staffing %", System.StringComparison.OrdinalIgnoreCase));
                foreach (var planned in plannedMetrics)
                {
                    var metricBase = planned.Header.Replace("Planned", "").Trim();
                    var actual = actualMetrics.FirstOrDefault(a => a.Header.Contains(metricBase, System.StringComparison.OrdinalIgnoreCase));
                    if (actual == null)
                    {
                        sb.AppendLine($"- Metric: {planned.Header} (no Actual data to compare)");
                        continue;
                    }
                    sb.AppendLine($"- Metric: {metricBase}");
                    sb.AppendLine($"Actual Trend:  {string.Join(", ", actual.Values.Where(x => Convert.ToDateTime(x.Week) < Convert.ToDateTime(request.Weeks.NextWeek)).Select(v => $"{v.Week}: {(v.NumValue * 100).ToString("N2")}%"))}");
                    sb.AppendLine($"Planned : {string.Join(", ", planned.Values.Where(x => Convert.ToDateTime(x.Week) >= Convert.ToDateTime(request.Weeks.NextWeek)).Select(v => $"{v.Week}: {(v.NumValue * 100).ToString("N2")}%"))}");
                    sb.AppendLine($"Staffing% Trend: {string.Join(", ", staffingPer?.Values.Select(v => $"{v.Week}: {(v.NumValue).ToString("N2")}%"))}");
                    sb.AppendLine("<hr>");
                }
                



            }

            sb.AppendLine(@"
<div style='font-family:Arial; font-size:14px;'>
    <p><strong>Task:</strong></p>
    <p>For each LOB, summarize ONLY:</p>
    <ol>
        <li>Key Alerts (2 lines)</li>
        <li>Recommendations (1–2 lines)</li>
    </ol>
    <p><strong>Output Format (strict):</strong></p>
    <p>For each LOB:</p>
    <p>
        <strong>&lt;name&gt;</strong><br/>
        - <p><strong>Alerts:</strong></p>:<br/>
        &nbsp;&nbsp;• &lt;Max 5–6 lines – biggest deviation&gt;<br/>
        &nbsp;&nbsp;• &lt;Max 5–6 lines – trend/holiday impact&gt;<br/>
        - <p><strong>Recommendations:</strong></p><br/>
        &nbsp;&nbsp;• &lt;Max 5–6 lines – actionable step&gt;<br/>
        &nbsp;&nbsp;• &lt;Max 5–6 lines – optional optimization&gt;<br/>
    </p>
    <p><strong>Rules:</strong></p>
    <ul>
        <li>Max 5–6 lines per LOB.</li>
        <li>No tables, no long paragraphs.</li>
        <li>Keep it short, sharp, and decision-oriented.</li>
    </ul>
</div>
");

            return sb.ToString();
        }
