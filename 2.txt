function compressJson(obj) {
    const json = JSON.stringify(obj);

    // gzip instead of deflate
    const compressed = fflate.gzipSync(
        new TextEncoder().encode(json), 
        { level: 9 }
    );

    return new Blob([compressed], { type: "application/octet-stream" });
}


using (var input = file.OpenReadStream())
using (var gzip = new GZipStream(input, CompressionMode.Decompress))
using (var reader = new StreamReader(gzip))
{
    var json = await reader.ReadToEndAsync();
    var sheets = JsonConvert.DeserializeObject<List<SaveSheetDto>>(json);
    ...
}
