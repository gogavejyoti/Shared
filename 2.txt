getSelectedCellsData: function () {
    const selDict = this._pivotCells?._selectedCells || {};
    const cellMap = {};

    // Parse keys as "col_row:"
    Object.keys(selDict).forEach(key => {
        const cleanedKey = key.replace(':', '');
        const [colStr, rowStr] = cleanedKey.split('_');
        const rowIdx = parseInt(rowStr, 10);  // second part = row
        const colIdx = parseInt(colStr, 10);  // first part = column
        const cell = selDict[key];

        const valObj = this.source.getCellValue(
            cell.pivotRow.adapterItem,
            cell.pivotColumn.adapterItem
        );
        const value = valObj?.formattedValue ?? '';

        if (!cellMap[rowIdx]) cellMap[rowIdx] = {};
        cellMap[rowIdx][colIdx] = value;
    });

    // Sort rows and columns
    const sortedRowIndices = Object.keys(cellMap).map(Number).sort((a, b) => a - b);
    const allColIndices = new Set();

    sortedRowIndices.forEach(rowIdx => {
        Object.keys(cellMap[rowIdx]).forEach(c => allColIndices.add(parseInt(c)));
    });

    const sortedColIndices = [...allColIndices].sort((a, b) => a - b);

    // Create final 2D array
    const result = sortedRowIndices.map(rowIdx => {
        return sortedColIndices.map(colIdx => {
            return cellMap[rowIdx][colIdx] ?? ""; // fill missing with blank
        });
    });

    return result;
}
