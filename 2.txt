 public static IEnumerable<dynamic> ToDynamicEnumerable(this DataTable table)
    {
        foreach (DataRow row in table.Rows)
        {
            IDictionary<string, object?> expando = new ExpandoObject();

            foreach (DataColumn column in table.Columns)
            {
                expando[column.ColumnName] = row[column] == DBNull.Value ? null : row[column];
            }

            yield return expando;
        }
    }
