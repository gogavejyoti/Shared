function removeDollarFromCrossSheet(formula) {
    // Regex to match any sheet-qualified reference, including ranges
    const sheetRefRegex = /(?:'([^']+)'|([A-Za-z0-9_]+))!([A-Z$]+)(\d+$|(\:[A-Z$]+\d+))/g;

    return formula.replace(sheetRefRegex, (match, quotedSheet, unquotedSheet, colPart, rowPart) => {
        // Remove $ from column and row parts
        const cleanedPart = match.replace(/\$/g, '');
        return cleanedPart;
    });
}
