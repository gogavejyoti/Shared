// Initialize change tracker
h.sheetChanges = {}; // key = sheetIndex, value = { insertedRows: [], deletedRows: [], insertedCols: [], deletedCols: [] }

// Function to record sheet changes
function trackSheetChange(sheetIndex, type, start, endOrCount) {
    if (!h.sheetChanges[sheetIndex]) {
        h.sheetChanges[sheetIndex] = { insertedRows: [], deletedRows: [], insertedCols: [], deletedCols: [] };
    }

    switch (type) {
        case "insertRow":
            h.sheetChanges[sheetIndex].insertedRows.push({ start: start, count: endOrCount });
            break;
        case "deleteRow":
            h.sheetChanges[sheetIndex].deletedRows.push({ start: start, end: endOrCount });
            break;
        case "insertCol":
            h.sheetChanges[sheetIndex].insertedCols.push({ start: start, count: endOrCount });
            break;
        case "deleteCol":
            h.sheetChanges[sheetIndex].deletedCols.push({ start: start, end: endOrCount });
            break;
    }
}
