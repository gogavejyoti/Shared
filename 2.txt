public static string BuildAiPrompt(List<ForecastMetric> entries, string programName)
{
    var builder = new StringBuilder();
    builder.AppendLine($"ðŸ“Š Forecast Summary for Program: **{programName}**");
    builder.AppendLine("Generate a concise and visually structured forecast analysis.");
    builder.AppendLine("Use arrows (â†’), bold text, emojis (ðŸ“ˆ, ðŸ“‰, âš ï¸), and show month names clearly.");
    builder.AppendLine("Summarize trends and focus on values for Month+1, Month+2, and Month+3.");
    builder.AppendLine();

    var groupedByMetric = entries.GroupBy(e => e.MetricName);

    foreach (var g in groupedByMetric)
    {
        builder.AppendLine($"**{g.Key}**:");
        foreach (var m in g.OrderBy(e => e.Month))
        {
            var monthName = CultureInfo.CurrentCulture.DateTimeFormat.GetAbbreviatedMonthName(m.Month.Month);
            builder.Append($"`{monthName}` â†’ {m.PredictedValue:F1}  ");
        }
        builder.AppendLine();
    }

    builder.AppendLine();
    builder.AppendLine("Conclude with overall trend and recommendation.");

    return builder.ToString();
}
