showSheet: function () {
    let e = this.getSheetIndex(h.currentSheetIndex),
        n = h.luckysheetfile[e];
    if (!n) return;

    // ü©π Force LuckySheet to recalc column/row positions if missing or outdated
    if (!Store.visibledatacolumn || Store.visibledatacolumn.length === 0) {
        Store.visibledatacolumn = [];
        let totalWidth = 0;
        for (let c = 0; c < Store.cols; c++) {
            totalWidth += Store.defaultcolumnlen;
            Store.visibledatacolumn.push(totalWidth);
        }
    }

    if (!Store.visibledatarow || Store.visibledatarow.length === 0) {
        Store.visibledatarow = [];
        let totalHeight = 0;
        for (let r = 0; r < Store.rows; r++) {
            totalHeight += Store.defaultrowlen;
            Store.visibledatarow.push(totalHeight);
        }
    }

    // üßÆ Recalculate total sheet dimensions accurately
    h.ch_width = Store.visibledatacolumn[Store.visibledatacolumn.length - 1] + Store.rowHeaderWidth;
    h.rh_height = Store.visibledatarow[Store.visibledatarow.length - 1] + Store.columnHeaderHeight;

    // üß≠ Update core DOM elements
    $("#luckysheet-cell-flow_0").css({
        width: h.ch_width,
        top: "-1px"
    });
    $("#luckysheet-sheettable_0").css({
        width: h.ch_width - 1,
        height: h.rh_height
    });
    $("#luckysheetrowHeader_0").css("height", h.rh_height);
    $("#luckysheet-cols-h-cells_0").css("width", h.ch_width);
    $("#luckysheet-scrollbar-x div").width(h.ch_width);
    $("#luckysheet-scrollbar-y div").height(
        h.rh_height + h.columnHeaderHeight - h.cellMainSrollBarSize - 3
    );

    // üß∑ Restore scroll positions
    h.scrollRefreshSwitch = !1;
    if (n.scrollLeft != null && n.scrollLeft > 0)
        $("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft * h.zoomRatio);
    else
        $("#luckysheet-scrollbar-x").scrollLeft(0);

    if (n.scrollTop != null && n.scrollTop > 0)
        $("#luckysheet-scrollbar-y").scrollTop(n.scrollTop * h.zoomRatio);
    else
        $("#luckysheet-scrollbar-y").scrollTop(0);

    setTimeout(() => { h.scrollRefreshSwitch = !0; }, 0);

    // üîÅ Force visible area recalculation
    if (typeof jfrefreshgrid_rhcw === "function") jfrefreshgrid_rhcw(); // LuckySheet built-in
    if (typeof ar === "function") ar(h.zoomRatio);
}
