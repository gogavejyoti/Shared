[HttpPost]
public async Task<IActionResult> SaveSheetsCompressed(IFormFile file)
{
    if (file == null || file.Length == 0)
        return BadRequest("No file uploaded.");

    using var input = file.OpenReadStream();
    using var deflate = new DeflateStream(input, CompressionMode.Decompress);
    using var reader = new StreamReader(deflate);
    var json = await reader.ReadToEndAsync();

    var sheets = JsonConvert.DeserializeObject<List<SaveSheetDto>>(json);

    var userId = User.GetIdByEmail();
    await _resourcePlannerService.SaveSheetsAsync(sheets, _vertical, userId);

    return Ok();
}
