SELECT MIN (EndWeek) FROM (
SELECT DISTINCT TOP 4 EndWeek FROM uvwVerticalSnapshotData WHERE EndWeek <=(
SELECT MAX(EndWeek) FROM uvwVerticalSnapshotData WHERE Vertical = 'Technology')
AND  Vertical = 'Technology'  ORDER BY EndWeek DESC
) as t
