let s = h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][0];

// CAPTURE CROSS-SHEET FORMULAS BEFORE INSERT
let crossSheetRefs = [];
if(typeof _shiftCrossSheetReference === "function"){
    if(h.luckysheetRightHeadClickIs == "column"){
        crossSheetRefs = captureCrossSheetRefs(
            h.currentSheetIndex,
            0,
            h.flowdata.length - 1,
            s,
            s + o - 1
        );
    } else {
        crossSheetRefs = captureCrossSheetRefs(
            h.currentSheetIndex,
            s,
            s + o - 1,
            0,
            h.flowdata[0].length - 1
        );
    }
}

// Call the original hook / insert
!Je.createHookFunction("rowInsertBefore", s, o, "lefttop", h.luckysheetRightHeadClickIs) ||
Sr(h.luckysheetRightHeadClickIs, s, o, "lefttop");

// SHIFT CROSS-SHEET REFERENCES
if(crossSheetRefs.length > 0){
    _shiftCrossSheetReference({
        type: h.luckysheetRightHeadClickIs == "column" ? "insertCol" : "insertRow",
        sheetIndex: h.currentSheetIndex,
        formulas: crossSheetRefs
    });
}
