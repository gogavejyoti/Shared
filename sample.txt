else if (e.type == "addRC") {
    Bn(e.curData, e.curConfig, "addRC", e.ctrlValue, e.curCalc, e.curFilterObj, e.curCf, e.curAf, e.curFreezen, e.curDataVerification, e.curHyperlink);

    // ✅ Shift cross-sheet references on undo
    if (typeof _shiftCrossSheetReference === "function") {
        if (e.ctrlValue.direction === "rightbottom") {
            _shiftCrossSheetReference({
                type: "deleteRow", // undo adding rows = delete
                sheetIndex: h.currentSheetIndex,
                rowIndex: e.ctrlValue.index,
                rowCount: e.ctrlValue.count || 1
            });
        } else if (e.ctrlValue.direction === "lefttop") {
            _shiftCrossSheetReference({
                type: "deleteCol", // undo adding columns = delete
                sheetIndex: h.currentSheetIndex,
                colIndex: e.ctrlValue.index,
                colCount: e.ctrlValue.count || 1
            });
        }
    }
}
else if (e.type == "delRC") {
    Bn(e.curData, e.curConfig, "delRC", e.ctrlValue, e.curCalc, e.curFilterObj, e.curCf, e.curAf, e.curFreezen, e.curDataVerification, e.curHyperlink);

    // ✅ Shift cross-sheet references on undo
    if (typeof _shiftCrossSheetReference === "function") {
        if (e.ctrlValue.direction === "lefttop") {
            _shiftCrossSheetReference({
                type: "insertRow", // undo deleting rows = insert
                sheetIndex: h.currentSheetIndex,
                rowIndex: e.ctrlValue.index,
                rowCount: e.ctrlValue.count || 1
            });
        } else if (e.ctrlValue.direction === "rightbottom") {
            _shiftCrossSheetReference({
                type: "insertCol", // undo deleting columns = insert
                sheetIndex: h.currentSheetIndex,
                colIndex: e.ctrlValue.index,
                colCount: e.ctrlValue.count || 1
            });
        }
    }
}
