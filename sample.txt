  <style id="weekAnalyticsPopupStyles">
                /* Modal Content Styling */
                #analyticsModal .modal-content { border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.12); font-family: 'Inter', sans-serif; background: #fafafa; }
                #analyticsModal .modal-header { border-bottom: 1px solid #e0e0e0; background-color: #D7C4F0; color: #2c2c2c; }
                #analyticsModal .modal-title { font-weight: 600; color: #2c2c2c; }
                #analyticsModal .btn-close { filter: invert(30%); }

                /* Table Wrapper */
                #analyticsModal .table-wrapper { overflow-x: auto; overflow-y: auto; max-height: 500px; position: relative; border: 1px solid #dcdcdc; background: #fff; border-radius: 8px; margin: 10px; }
                #analyticsModal table { border-collapse: collapse; width: max-content; table-layout: auto; }
                #analyticsModal th, #analyticsModal td { padding: 8px; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; border-top: 1px solid #eaeaea; background: #fff; }

                /* Sticky Headers */
                #analyticsModal thead th { position: sticky; top: 0; background: #f5f5f5; z-index: 6; }
                #analyticsModal thead th.sticky-left { position: sticky; top: 0; left: 0; background: #f5f5f5; z-index: 9; min-width: 140px; }
                #analyticsModal thead th.sticky-left-2 { position: sticky; top: 0; left: 140px; background: #f5f5f5; z-index: 9; min-width: 150px; }

                #analyticsModal tbody td.sticky-left { position: sticky; left: 0; background: #f0f0f0; z-index: 7; min-width: 140px; }
                #analyticsModal tbody td.sticky-left-2 { position: sticky; left: 140px; background: #f0f0f0; z-index: 7; min-width: 150px; }

                /* Conditional Coloring */
                #analyticsModal .rag-red { color: #e74c3c; font-weight: bold; }
                #analyticsModal .rag-amber { color: #f39c12; font-weight: bold; }
                #analyticsModal .rag-green { color: #27ae60; font-weight: bold; }

                /* Filter Container */
                #analyticsModal .filter-container { margin: 10px; font-size: 0.875rem; }
                .dropdown-checkbox { max-height: 250px; overflow-y: auto; padding: 10px; }

                /* Buttons */
                #analyticsModal .btn-sm { border-radius: 6px; font-size: 0.875rem; }
                #applyFilterBtn { background: #9b59b6; border-color: #9b59b6; }
                #applyFilterBtn:hover { background: #8e44ad; border-color: #8e44ad; }
            </style>




    function showValidationSummary(sheetNames, results) {
        // Remove old modal if exists
        $('#validationSummaryModal').remove();

        // Build modal dynamically
        let modalHtml = `
    <div class="modal fade" id="validationSummaryModal" tabindex="-1" style="z-index:9999;zoom:75%">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title">Configuration Validation Summary</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <table class="table table-bordered table-hover align-middle">
              <thead class="table-light">
                <tr>
                  <th>Sheet Name</th>
                  <th>Status</th>
                  <th>Details</th>
                </tr>
              </thead>
              <tbody id="validationSummaryBody">`;

        sheetNames.forEach(sheet => {
            const r = results[sheet];

            let statusBadge = r.valid
                ? '<span class="badge bg-success">Valid</span>'
                : '<span class="badge bg-danger">Invalid</span>';

            let details = "";
            if (r.valid) {
                details = '<span class="text-success">All checks passed</span>';
            } else {
                details = '<ul class="mb-0">';
                r.errors.forEach(e => {
                    details += `<li class="text-danger">${e}</li>`;
                });
                details += '</ul>';
            }

            modalHtml += `
          <tr>
            <td><strong>${sheet}</strong></td>
            <td>${statusBadge}</td>
            <td>${details}</td>
          </tr>`;
        });

        modalHtml += `
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>`;

        // Append and show modal
        $('body').append(modalHtml);
        $('#validationSummaryModal').modal({
            backdrop: 'static',
            keyboard: false
        }).modal('show');
    }
